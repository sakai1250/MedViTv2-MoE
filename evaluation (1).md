# -*- coding: utf-8 -*-
"""Evaluation.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1AAR7XL4SqEuewEVhuYXQDzLxEDxS2pN0

#MedViTV2

For training and evaluating the model, it is recommended to use a GPU due to the high computational requirements.
"""

# !nvidia-smi

# pip install torch==2.5.0 torchvision==0.20.0 torchaudio==2.5.0 --index-url https://download.pytorch.org/whl/cu124

# !pip3 install natten==0.17.3+torch250cu124 -f https://shi-labs.com/natten/wheels/

"""To get started, clone the repository and navigate to the project directory:"""

# # Commented out IPython magic to ensure Python compatibility.
# !git clone https://github.com/Omid-Nejati/MedViTV2.git
# # %cd /content/MedViTV2

# !pip install -r requirements.txt

"""### ðŸ§  Train Different Versions of MedViT on 17 Datasets  

You can easily train different versions of MedViT by specifying the model and dataset names:  

 ðŸ”¹ **Model Selection:**  
```bash
--model_name [MedViT_tiny, MedViT_small, MedViT_base, MedViT_large]

ðŸ“Š **Dataset Selection:**  
```bash
--dataset [tissuemnist, pathmnist, chestmnist, dermamnist, octmnist,
           pneumoniamnist, retinamnist, breastmnist, bloodmnist,
           organamnist, organcmnist, organsmnist, Kvasir, CPN,
           Fetal, PAD, ISIC2018]

!!!! The process of downloading the dataset for the first time may take a while, so please be patient. ðŸ˜Š
"""

!python main.py --model_name 'MedViT_large' --dataset 'breastmnist' --pretrained False

"""###Train timm models
ðŸ¤¯ You can easily train any model from TIMM on each dataset by simply changing the model name. If a pre-trained version is available, you can enable it by setting the corresponding flag to True.

link: https://timm.fast.ai/
"""

!python main.py --model_name 'resnet34' --dataset 'octmnist' --pretrained True